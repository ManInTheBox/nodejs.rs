var Assert = require('assert'),
    util = require('../lib/util');

module.exports = {
  'stuff dots': function() {
    var stuffed = util.stuffDots("foo\r\n.\r\nbar");
    Assert.equal(stuffed, "foo\r\n..\r\nbar");
  },

  '78/998 line length limits': function() {
    var body = util.fill("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque dui lectus, suscipit nec bibendum et, tristique pretium quam. Curabitur ultricies congue felis, sit amet mattis diam varius rutrum. Cras iaculis gravida enim, ac pellentesque sapien posuere non. Praesent non nulla lorem, in gravida ligula. Donec ultricies, purus nec congue hendrerit, elit tellus bibendum felis, sed commodo magna nunc ut nulla. Nulla facilisi. Praesent vitae magna at neque semper viverra. Sed lobortis neque quis justo dictum sit amet ultricies augue consequat. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Aliquam eleifend mattis blandit. Quisque in leo in lectus vulputate adipiscing eu a felis. Quisque vel purus non enim rutrum fringilla.\rMorbi consectetur dignissim iaculis. Vivamus at purus enim, at viverra nisl. Vestibulum ac consequat quam. Mauris ipsum nunc, feugiat at dictum eu, tincidunt id odio. Nullam egestas pretium urna gravida sagittis. Praesent aliquet purus nisl. Quisque ut fringilla tortor. Nulla facilisi. Sed id sollicitudin turpis. Sed quis erat sapien. Praesent vulputate nulla a neque varius a fermentum nibh aliquet. Cras nisi ipsum, scelerisque ut euismod non, mattis et eros. Morbi scelerisque, erat eget ultrices volutpat, dolor justo interdum erat, accumsan hendrerit sapien est suscipit lorem. Quisque egestas aliquet diam, eget malesuada neque commodo nec. Suspendisse potenti. Nulla lacinia quam metus. Sed sit amet mi ac lectus aliquet eleifend. Donec tempus odio rutrum tortor placerat malesuada. Proin semper lacus cursus risus fermentum ullamcorper.\r\nDuis imperdiet vehicula vestibulum. Nunc augue velit, feugiat vitae fringilla in, condimentum at enim. In hac habitasse platea dictumst. Aenean eleifend commodo felis, vitae mattis diam semper a. Aenean velit diam, aliquam in fringilla sit amet, elementum ac quam. Cras laoreet dolor ac eros sollicitudin at aliquet quam tincidunt. Vivamus est erat, ornare ac interdum vel, pretium eget ante. Sed egestas viverra risus, aliquam pulvinar sem mattis non. Pellentesque dapibus scelerisque nisl id convallis. Vestibulum ut arcu tellus. Ut vehicula sagittis velit, at semper justo suscipit ac. Donec lorem lorem, hendrerit non dapibus ut, mattis a arcu. Curabitur non mauris tortor, sed condimentum lorem. Proin egestas mauris ut elit rutrum molestie.\nDuis erat nulla, porta a tincidunt vel, imperdiet et augue. Donec ac diam eu est iaculis tempus. Maecenas vel tristique est. Nam vitae sagittis libero. Donec et tellus arcu. Vestibulum eleifend felis dictum risus pharetra fringilla malesuada neque dapibus. Pellentesque posuere urna eros, sed sagittis dui. Integer non velit urna, sed vulputate nisl. In et velit sed sem iaculis adipiscing. Duis id quam lacus. Suspendisse scelerisque libero eget ligula pharetra cursus. Phasellus feugiat dignissim tortor, sit amet mattis risus eleifend ac. Suspendisse in tellus non risus viverra laoreet sed in erat. Integer non massa nisl. Suspendisse fringilla fringilla tincidunt. Nullam eu ligula erat. Nunc nec mi ut urna tristique faucibus at sit amet tellus. Nulla interdum sollicitudin nisl at vehicula.\nNulla hendrerit, urna at tincidunt vulputate, est purus hendrerit nisl, at molestie elit odio a nisi. Proin bibendum facilisis sollicitudin. Suspendisse sed vestibulum ligula. Proin et consequat ligula. Praesent tristique, est sed consequat aliquet, lorem tortor laoreet augue, nec tincidunt sapien lorem et nisl. Maecenas ut eros sed libero interdum venenatis et tincidunt ligula. Pellentesque eleifend ultrices odio id egestas. Donec blandit lorem id tellus egestas gravida. Pellentesque pretium adipiscing dignissim. Nullam nunc mauris, feugiat nec molestie in, imperdiet non est. Nulla quis gravida ligula. Donec nunc eros, placerat sed volutpat ut, suscipit at lectus.\r\nCurabiturmalesuadamolestiemaurisnongravida.Fuscescelerisquedoloraliquamnislconsecteturvarius.Invelviverraelit.Quisquepurusrisus,pulvinaregestasvestibulumin,vehiculabibendumipsum.Integerinarcudolor.Nullaporttitorsemegetnullaimperdieteuismod.Curabiturmaurismagna,sollicitudinsedconvallisnec,vulputatequisnunc.Donecduidui,pulvinarasemperid,vehiculavitaeneque.Donecultricieslectussitametelittristiquerhoncus.Praesentvitaenisilectus.Suspendissevenenatisvelitquisduimalesuadasollicitudin.Donecaelementumlibero.Sedlaciniaultricieslacinia.Vestibulumetmaurisligula.Naminterdumornarecondimentum.Etiamauguevelit,tristiqueetluctuset,vulputateaccumsannisl.Phasellusquiserosinnibhsagittisiaculis.Crasidurnaeuerosultriciesmolestie.Sedquisantecommodoenimdignissimcondimentum.Nullaathendreriturna.Proinviverranisilectus,intristiquelectus.Utvitaeeratmetus.Nullasedsagittismauris.Praesentornarepellentesqueodio,acfermentumnullavehiculaeu.Nuncfacilisis,ipsumasodalessemper,arcuvelitornaresem,idtemporeratjustonecarcu.Vestibulumdapibussagittislectus.Pellentesquehabitantmorbitristiquesenectusetnetusetmalesuadafamesacturpisegestas.Curabituraliquamorcivelestsodalesquisblanditmiscelerisque.Namdiamsem,rutrumidfacilisisid,ultriciesnecpurus.Pellentesqueorcitellus,placeratutluctusac,egestasnonsem.\r\n");
    Assert.equal(body, 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque dui lectus, \r\nsuscipit nec bibendum et, tristique pretium quam. Curabitur ultricies congue \r\nfelis, sit amet mattis diam varius rutrum. Cras iaculis gravida enim, ac \r\npellentesque sapien posuere non. Praesent non nulla lorem, in gravida ligula. \r\nDonec ultricies, purus nec congue hendrerit, elit tellus bibendum felis, sed \r\ncommodo magna nunc ut nulla. Nulla facilisi. Praesent vitae magna at neque \r\nsemper viverra. Sed lobortis neque quis justo dictum sit amet ultricies augue \r\nconsequat. Class aptent taciti sociosqu ad litora torquent per conubia nostra, \r\nper inceptos himenaeos. Aliquam eleifend mattis blandit. Quisque in leo in \r\nlectus vulputate adipiscing eu a felis. Quisque vel purus non enim rutrum \r\nfringilla.\r\nMorbi consectetur dignissim iaculis. Vivamus at purus enim, at viverra nisl. \r\nVestibulum ac consequat quam. Mauris ipsum nunc, feugiat at dictum eu, \r\ntincidunt id odio. Nullam egestas pretium urna gravida sagittis. Praesent \r\naliquet purus nisl. Quisque ut fringilla tortor. Nulla facilisi. Sed id \r\nsollicitudin turpis. Sed quis erat sapien. Praesent vulputate nulla a neque \r\nvarius a fermentum nibh aliquet. Cras nisi ipsum, scelerisque ut euismod non, \r\nmattis et eros. Morbi scelerisque, erat eget ultrices volutpat, dolor justo \r\ninterdum erat, accumsan hendrerit sapien est suscipit lorem. Quisque egestas \r\naliquet diam, eget malesuada neque commodo nec. Suspendisse potenti. Nulla \r\nlacinia quam metus. Sed sit amet mi ac lectus aliquet eleifend. Donec tempus \r\nodio rutrum tortor placerat malesuada. Proin semper lacus cursus risus \r\nfermentum ullamcorper.\r\nDuis imperdiet vehicula vestibulum. Nunc augue velit, feugiat vitae fringilla \r\nin, condimentum at enim. In hac habitasse platea dictumst. Aenean eleifend \r\ncommodo felis, vitae mattis diam semper a. Aenean velit diam, aliquam in \r\nfringilla sit amet, elementum ac quam. Cras laoreet dolor ac eros sollicitudin \r\nat aliquet quam tincidunt. Vivamus est erat, ornare ac interdum vel, pretium \r\neget ante. Sed egestas viverra risus, aliquam pulvinar sem mattis non. \r\nPellentesque dapibus scelerisque nisl id convallis. Vestibulum ut arcu tellus. \r\nUt vehicula sagittis velit, at semper justo suscipit ac. Donec lorem lorem, \r\nhendrerit non dapibus ut, mattis a arcu. Curabitur non mauris tortor, sed \r\ncondimentum lorem. Proin egestas mauris ut elit rutrum molestie.\r\nDuis erat nulla, porta a tincidunt vel, imperdiet et augue. Donec ac diam eu \r\nest iaculis tempus. Maecenas vel tristique est. Nam vitae sagittis libero. \r\nDonec et tellus arcu. Vestibulum eleifend felis dictum risus pharetra \r\nfringilla malesuada neque dapibus. Pellentesque posuere urna eros, sed \r\nsagittis dui. Integer non velit urna, sed vulputate nisl. In et velit sed sem \r\niaculis adipiscing. Duis id quam lacus. Suspendisse scelerisque libero eget \r\nligula pharetra cursus. Phasellus feugiat dignissim tortor, sit amet mattis \r\nrisus eleifend ac. Suspendisse in tellus non risus viverra laoreet sed in \r\nerat. Integer non massa nisl. Suspendisse fringilla fringilla tincidunt. \r\nNullam eu ligula erat. Nunc nec mi ut urna tristique faucibus at sit amet \r\ntellus. Nulla interdum sollicitudin nisl at vehicula.\r\nNulla hendrerit, urna at tincidunt vulputate, est purus hendrerit nisl, at \r\nmolestie elit odio a nisi. Proin bibendum facilisis sollicitudin. Suspendisse \r\nsed vestibulum ligula. Proin et consequat ligula. Praesent tristique, est sed \r\nconsequat aliquet, lorem tortor laoreet augue, nec tincidunt sapien lorem et \r\nnisl. Maecenas ut eros sed libero interdum venenatis et tincidunt ligula. \r\nPellentesque eleifend ultrices odio id egestas. Donec blandit lorem id tellus \r\negestas gravida. Pellentesque pretium adipiscing dignissim. Nullam nunc \r\nmauris, feugiat nec molestie in, imperdiet non est. Nulla quis gravida ligula. \r\nDonec nunc eros, placerat sed volutpat ut, suscipit at lectus.\r\nCurabiturmalesuadamolestiemaurisnongravida.Fuscescelerisquedoloraliquamnislconsecteturvarius.Invelviverraelit.Quisquepurusrisus,pulvinaregestasvestibulumin,vehiculabibendumipsum.Integerinarcudolor.Nullaporttitorsemegetnullaimperdieteuismod.Curabiturmaurismagna,sollicitudinsedconvallisnec,vulputatequisnunc.Donecduidui,pulvinarasemperid,vehiculavitaeneque.Donecultricieslectussitametelittristiquerhoncus.Praesentvitaenisilectus.Suspendissevenenatisvelitquisduimalesuadasollicitudin.Donecaelementumlibero.Sedlaciniaultricieslacinia.Vestibulumetmaurisligula.Naminterdumornarecondimentum.Etiamauguevelit,tristiqueetluctuset,vulputateaccumsannisl.Phasellusquiserosinnibhsagittisiaculis.Crasidurnaeuerosultriciesmolestie.Sedquisantecommodoenimdignissimcondimentum.Nullaathendreriturna.Proinviverranisilectus,intristiquelectus.Utvitaeeratmetus.Nullasedsagittismauris.Praesentornarepellentesqueodio,acfermentumnullavehiculaeu.Nuncfacilisis,ipsumasodalessemper,arcuvelitornaresem,idtemporeratjustonecarcu.V\r\nestibulumdapibussagittislectus.Pellentesquehabitantmorbitristiquesenectusetnetusetmalesuadafamesacturpisegestas.Curabituraliquamorcivelestsodalesquisblanditmiscelerisque.Namdiamsem,rutrumidfacilisisid,ultriciesnecpurus.Pellentesqueorcitellus,placeratutluctusac,egestasnonsem.\r\n');
  },

  'header values escaped': function() {
    var header = util.escapeHeader('value\r\ncc: name@example.net');
    Assert.equal(header, 'value cc: name@example.net');
  },

  'header folding': function() {
    var header = util.foldHeader('Subject', 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque dui lectus, suscipit nec bibendum et, tristique pretium quam.');
    Assert.equal(header, 'Subject: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque dui\r\n lectus, suscipit nec bibendum et, tristique pretium quam.');
  }
};
